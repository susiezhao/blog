{"data":{"site":{"siteMetadata":{"title":"Blog","author":"susiezhao"}},"markdownRemark":{"id":"202e9a20-3751-579b-bf2a-beb2a62f54fe","excerpt":"JavaScript 也是一种面向对象的语言，在 JavaScript 中一切皆为对象。 JavaScript 采用的是基于原型的面向对象系统，且通过基于原型链的方式来实现继承的。 原型与原型链 构造函数、原型对象及实例的关系 在 JavaScript 中所有的函数都有一个不可枚举的  prototype…","html":"<p>JavaScript 也是一种面向对象的语言，在 JavaScript 中一切皆为对象。 JavaScript 采用的是基于原型的面向对象系统，且通过基于原型链的方式来实现继承的。</p>\n<h2>原型与原型链</h2>\n<h3>构造函数、原型对象及实例的关系</h3>\n<p>在 JavaScript 中所有的函数都有一个不可枚举的 <code>prototype</code> 的属性，该属性是一个指针，指向一个被称为原型的对象（即原型）。原型对象有一个默认不可枚举的 <code>constructor</code> 属性，其也是一个指针，默认指向与原型对象关联的函数。例如：  <code>function Foo() {}</code> 的原型对象是 <code>Foo.prototype</code>，则有 <code>Foo.proptotype.constructor === Foo</code> 成立。  </p>\n<p>在 JavaScript 中通过关键字 <code>new</code> 调用的函数通常被称为构造函数。在默认的约定中，构造函数的首字母始终为大写字母，非构造函数的首字母则以一个小写字母开头。构造函数通常是用来创建特定类型的对象，且通过构造函数生成的对象称为该构造函数的实例。\n构造函数又分为原生构造函数，如 <code>Array</code>、 <code>String</code>、 <code>RegExp</code> 等，还可以自定义构造函数。通常采用 <code>instanceof</code> 来检测对象的类型。即对象的 <code>constructor</code> 属性。 对象上的 <code>constructor</code> 属性本质上是获取的对应原型对象上的 <code>constructor</code> 属性。<br>\n构造函数必须使用 <code>new</code> 操作符调用，且调用的过程中经历了下面4个阶段：</p>\n<ul>\n<li>创建了一个新对象；</li>\n<li>将构造函数的作用域赋值给创建的新对象（<code>this</code> 指向上面步骤中的新对象）</li>\n<li>执行构造函数的代码，即为新对象添加属性等</li>\n<li>\n<p>返回这个新对象</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Person</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">,</span> sex</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> ange<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sex <span class=\"token operator\">=</span> sex<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> person1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Person</span><span class=\"token punctuation\">(</span><span class=\"token string\">'susie'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'female'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n</li>\n</ul>\n<p>在 JavaScript 中一切皆为对象，且所有对象都存在一个内置属性 <code>[[prototype]]</code>, 通常可以通过 <code>Object.getPrototypeOf(obj)</code> 获取。 在 Firefox, Safari 和 Chrome 浏览器中该内置属性可以通过 <code>__proto__</code> 获取。该属性是一个指针，指向构造该对象i的构造函数的原型对象。即 <code>[[prototype]]</code> 这个链接是存在于实例对象和对应的原型对象之间，而不是存在实例对象和对应的构造函数之间。实例对象，构造函数和原型对象之间的关系是：\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33487f9f527a6cdf9ecfa3d7eee80dfe/ef3f5/prototype1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 43.666169895678095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA60lEQVQoz41Si46EIAz0/3/T5UBBcQV1ffaY3tWgMZcjmRRbO52OFvu+U45t2y7xCX/VinviOI4L1nVlAoHk/0m4UdM4stbSsizU9z29u4689+Rbn2oN52TIk9oiT86fDznnuCnGyMRVVZFSisqypNdLMWmXhohSOSchkuM4kjGGtNEchUQlAmsdE+AdWRnD8DxNE4U+nKpPwnmeea22bTnWdU0hhItX+UENiHFIw97UpR5YdPEQ0zFF/BHl4Xd9qABABMX38+jh/WujUX/ppPjHS9y1NjQMwykix+NvkwNrQB0IANyRyxXd8Q3UzL65Qxg1zQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"构造函数，原型以及实例之间的关系\"\n        title=\"\"\n        src=\"/static/33487f9f527a6cdf9ecfa3d7eee80dfe/b9e4f/prototype1.png\"\n        srcset=\"/static/33487f9f527a6cdf9ecfa3d7eee80dfe/cf440/prototype1.png 148w,\n/static/33487f9f527a6cdf9ecfa3d7eee80dfe/d2d38/prototype1.png 295w,\n/static/33487f9f527a6cdf9ecfa3d7eee80dfe/b9e4f/prototype1.png 590w,\n/static/33487f9f527a6cdf9ecfa3d7eee80dfe/ef3f5/prototype1.png 671w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n      </p>\n<h3>原型与实例的关系</h3>\n<p>获取原型与实例的关系主要有两个方法：</p>\n<ul>\n<li><code>instanceof</code>: 只要在该实例的原型中出现的构造函数，结果都会返回 <code>true</code>;</li>\n<li><code>isPrototypeOf()</code>: 只要是该原型链上出现过的原型对象，结果都会返回 <code>true</code>。</li>\n</ul>\n<p>实例设置与获取原型对象的的方法：</p>\n<ul>\n<li><code>Object.create()</code>: ES6 之前采用的方法， <code>Bar.prototype = Object.create(Foo.prototype)</code></li>\n<li><code>Object.setPrototypeOf()</code>: ES6 提供的新的方法， <code>Object.setPrototypeOf(Bar.prototype, Foo.prototype)</code></li>\n<li><code>Object.getPrototypeOf()</code>: 获取一个对象的原型对象</li>\n</ul>\n<h4><code>Object.create</code></h4>\n<p>调用方式: <code>Object.create(proto, [propertiesObject])</code></p>\n<ul>\n<li><code>proto</code>: 新创建对象的原型对象。</li>\n<li><code>propertiesObject</code>: 可选。如果没有指定为 <code>undefined</code>，则是要添加到新创建对象的可枚举属性（即其自身定义的属性，而不是其原型链上的枚举属性）对象的属性描述符以及相应的属性名称。</li>\n</ul>\n<h2>原型链</h2>\n<p>在 JavaScript 中一切皆被称为对象。每个对象内都存在一个 <code>[[prototype]]</code> 的内部链接指向该实例的原型对象。当在一个对象上查找一个属性或者方法时，如果找到就直接放回，否则引擎就会在对象的 <code>[[prototype]]</code> 所指向的原型对象上继续查找，过程以此类推。在整个过程中这一系列的对象的链接构成了原型链。<br>\n原型链是 JavaScript 实现类继承的主要依据。在其他语言中继承通常意味着复制操作，但是在 JavaScript 中的继承是有原型链实现的，其本质是在两个对象之间建立起一个关联，这样一个对象就可以通过原型链查找方法访问到与之关联对象的属性和方法。<br>\n<strong>注意：</strong> 基于原型链实现的继承是动态的继承，即对原型对象的任何修改都能立刻在对应的实例上反映出来。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">SuperType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>property <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">SuperType</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getSuperValue</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>property<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">SubType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subproperty <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">SubType</span><span class=\"token punctuation\">.</span>prototype <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SuperType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">SubType</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">getSubValue</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subprototype<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SubType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">.</span><span class=\"token function\">getSuperValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>instance <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">SubType</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// true</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>instance <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">SuperType</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>instance <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// true</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">isPrototypeOf</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true </span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SuperType</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">isPrototypeOf</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// true</span>\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SubType</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">isPrototypeOf</span><span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">// true</span></code></pre></div>\n<p>完整的原型链如下所示: \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/141301f05289752d7f2176ca312b12d4/7dc55/prototype2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 92.25037257824144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/ElEQVQ4y32UV3PCQAyE/f//FW88haENvZheDRhMB4VPyTKEEs9oOPukvdXuieByudjxeLTFYmGDwcDiOLYkSWy73dput7Plcul7URT5WkENtc8RnE4nLwzD0Eajke33e7ter14A6Hg8tkaj4fu1Ws02m42t12s7HA7GQ67iDkgCBc1m09nAUCxWq5WDlstla7fbfshsNnMSIkM+wXuglgGlXRiez2dPYA/AXq9n6XTastmsg83ncwcCnDWdIQk4gXqHslrgoYC1imDfarUcnEOVK2nIh0jwCMYa2iTBEL1kECAEa30n90VDUEFHn26369pRyDckmE6n7r5iOBy6zoBiDCBg/HEZkGKxaKVSybXgGwwABbBer3vQMoEE7AMoZndAGYCw6IMJYkdy/OtyIZ93MJhhjBi+AIqygvcfU7a+jm+Fw9HYvjIZyxUKtlzFHroNLxf72WFtIL7fw3Vi82hhYadjYbdns1u78SZ5YfYHUO7Rgpyjbe7m5NYurWIIpvGL5u/avWvY7/ctlUq5MZoUaTSZTKxarVqlUvFpkcsa0beAAOha6I7BkIc1znMYTmss3+l3ByQBh3Uy2mlScBuXc7mcsyRXY/kRkHvFnMJQUyGGvAOCLADTAfsfATGBKdHFphAGj/93ugUaz//CGSI8p0vwd2J/0uw5vgEopWqEerD2qQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"完整的原型链\"\n        title=\"\"\n        src=\"/static/141301f05289752d7f2176ca312b12d4/b9e4f/prototype2.png\"\n        srcset=\"/static/141301f05289752d7f2176ca312b12d4/cf440/prototype2.png 148w,\n/static/141301f05289752d7f2176ca312b12d4/d2d38/prototype2.png 295w,\n/static/141301f05289752d7f2176ca312b12d4/b9e4f/prototype2.png 590w,\n/static/141301f05289752d7f2176ca312b12d4/f9b6a/prototype2.png 885w,\n/static/141301f05289752d7f2176ca312b12d4/2d849/prototype2.png 1180w,\n/static/141301f05289752d7f2176ca312b12d4/7dc55/prototype2.png 1342w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    <br>\n<strong>注意：</strong>所有对象都默认是 <code>Object</code> 的实例。</p>\n<h2>ES6 之前的类</h2>\n<p>在 ES6 之前，JavaScript 采用构造函数以及原型的机制来模拟类的实现。如：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Person</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">,</span> sex</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> ange<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sex <span class=\"token operator\">=</span> sex<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> person1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Person</span><span class=\"token punctuation\">(</span><span class=\"token string\">'susie'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'female'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"JavaScript 基于原型的面向对象设计","date":"May 01, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/javascript/prototype_and_inheritance/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World"}},"next":{"fields":{"slug":"/hello-world/index1/"},"frontmatter":{"title":"Hello World1"}}}}